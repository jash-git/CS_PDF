<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0063)http://www.cc.ntu.edu.tw/chinese/epaper/0016/20110320_1610.html -->
<html xmlns="http://www.w3.org/TR/REC-html40" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml"><head><meta http-equiv="Content-Type" content="text/html; charset=Big5"><title>使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)</title><link rel="stylesheet" type="text/css" href="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/adress.css"><style type="text/css"><!--body {	background-image: url('../0002/images/square.gif');}--></style></head><body link="#49B3C1"><center><table width="800" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">   <tbody><tr bgcolor="#000000" class="eptop">    <td align="right" height="20">│ 	<a href="http://www.cc.ntu.edu.tw/chinese/epaper/editor.htm">編輯室</a> │ <a href="http://www.ntu.edu.tw/" target="_blank">臺大首頁</a> │ <a href="http://www.cc.ntu.edu.tw/" target="_blank">計中首頁</a> │ 	 </td>  </tr>  <tr>    <td height="150" align="right" valign="bottom" background="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/headimage.jpg" class="ep_head">	<p style="margin-top: 0">第0016期 	• 2011.03.20 發行</p><p style="margin-top: 0">	<span lang="EN-GB" style="font-family: Arial,sans-serif">		<strong><font size="3">ISSN 2077-8813</font></strong></span></p></td>  </tr></tbody></table>  <table width="800" border="0" cellpadding="0" cellspacing="1" bgcolor="#FFFFFF">   <tbody><tr align="center" bgcolor="#DAD8DA" class="eptop1">    <td align="center">	<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/button.gif" align="middle" width="13" height="13">	<a href="http://epaper.ntu.edu.tw/?p=view&amp;listid=2">歷史回顧</a></td>	<td align="center">	<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/button.gif" align="middle" width="13" height="13">	 <a href="http://epaper.ntu.edu.tw/?setlanguage=zh-tw&amp;p=subscribe&amp;id=1&amp;listid=2">	訂閱/取消</a></td>    <td align="center">	<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/button.gif" align="middle" width="13" height="13"><font size="3">	<a href="http://www.cc.ntu.edu.tw/chinese/epaper/0016/#service">校務服務</a></font></td>    <td align="center">	<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/button.gif" align="middle" width="13" height="13"><font size="3">	<a href="http://www.cc.ntu.edu.tw/chinese/epaper/0016/#report">專題報導</a></font></td>    <td align="center">	&nbsp;<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/button.gif" align="middle" width="13" height="13"><font size="3">	</font>	<a style="font-size: 12pt" href="http://www.cc.ntu.edu.tw/chinese/epaper/0016/#forum">技術論壇</a></td>    <td align="center">	<font size="3">	<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/button.gif" align="middle" width="13" height="13">  	<a href="http://www.cc.ntu.edu.tw/chinese/epaper/0016/#ntuepaper">推薦刊物</a></font></td>  </tr>  <tr align="center">    <td align="center" colspan="6" width="800">	<table width="740" border="0" cellpadding="0" cellspacing="1" bgcolor="#FFFFFF"> 		  <tbody><tr>			<td class="epimg" height="24">			<a href="http://www.cc.ntu.edu.tw/chinese/epaper/0016/index.html">首頁</a> &gt;技術論壇</td>		  </tr>		  <tr>			<td class="headline" background="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/bg.jpg">			<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/button1.gif" align="middle" width="13" height="13"> 			<strong>技術論壇</strong></td>		  </tr>		  <tr>			<td valign="top" class="epcontent">			<h1 class="style2">使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)</h1>			作者：唐瑤瑤 / 臺灣大學計算機及資訊網路中心程式設計組程式設計師<hr size="1" color="#CCCCCC">            			<p>			<font color="#990000">上一期的計中電子報中，我們向各位介紹了iTextSharp 			這個十分強大且免費的PDF函式庫，相信各位對它應該已經不陌生了。接下來我們就針對幾項進階功能做介紹，包含Direct 			content、Header、Footer、Barcode及JavaScript等互動功能。</font><br>　</p>			<p style="text-align: left">			<b>Part 1：Direct content<br>			</b>Direct content 是指在頁面的絕對位置中插入內容。範例中會使用到的是PdfContentByte及ColumnText 			2個類別。首先於頁面中加入一張圖檔，接著我們在圖片的【上方 upper layer】寫字，在圖片的【下方 lower 			layer】畫一個矩形並填滿色彩。主要使用到的方法是PdfWriter.DirectContent 及PdfWriter.DirectContentUnder：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610001.gif"></p>			<p style="text-align: left">			產生的結果如下圖：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610002.jpg"></p>			<p style="text-align: left">			接下來我們在頁面絕對座標位置上任意畫幾條直線：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610003.gif"></p>			<p style="text-align: left">			如果是利用ColumnText 顯示文字內容於頁面絕對位置，請參考下列程式碼：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610004.gif"></p>			<p style="text-align: left">			產生的結果如下圖：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610005.jpg"></p>			<p style="text-align: left">			<b>Part 2：Header及Footer<br>			</b>如果我們希望針對每一頁都能加上Header或Footer時，除了需要用到Part 1 提到的Direct 			Content，最重要是要處理Page Event，也就是PdfPageEventHelper介面。<br>			可以override 			事件如下：OnChapter、OnChapterEnd、OnCloseDocument、OnEndPage、OnGenericTag、OnOpenDocument、OnParagraph、OnParagraphEnd、OnSection、OnSectionEnd、OnStartPage。我們可以針對程式需求，挑出需要使用到的事件來改寫。<br>			在我們的範例程式中，希望能於頁尾顯示頁數及檔案建立時間。所以我們先建立Page Event class，並改寫OnOpenDocument 			方法。PdfTemplate 是在每一頁頁尾用來存放總頁數的值：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610006.gif"></p>			<p style="text-align: left">			接著override OnEndPage 方法。我們將在每一頁右上角Header顯示”NTU 			C&amp;INC”文字；左下角Footer顯示頁數與總頁數、右下角Footer 顯示文件產生的日期與時間。使用ShowTextAligned、ShowTextMatrix、ShowText 			等方法設定文字顯示的絕對位置，並保留好template 的位置以顯示總頁數：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610007.gif"></p>			<p style="text-align: left">			最後 override OnCloseDocument 方法，因為template 的位置已經都保留了，所以只要填入內容即可。</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610008.jpg"></p>			<p style="text-align: left">			　</p>			<p style="text-align: left">			<b>Part 3：Barcode條碼<br>			</b>iTextSharp 提供直覺的方式來產生各種條碼，包括Barcode、QR Code 等。您也可以利用上一節的Page 			event 作法於每一頁頁尾產生文件條碼，使用PlaceBarcode 方法即可。程式碼很容易懂，直接複製如下：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610009.gif"></p>			<p style="text-align: left">			產生結果如下圖：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610010.jpg"></p>			<p style="text-align: left">			　</p>			<p style="text-align: left">			<b>Part 4：利用javascript與使用者互動<br>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610011.gif"></b></p>			<p style="text-align: left">			完整程式碼如下：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610012.gif"></p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610013.gif"></p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610014.gif"></p>			<p style="text-align: left">			Javascript 程式碼很簡單：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610015.gif"></p>			<p style="text-align: left">			產生的結果如下圖：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610016.jpg" width="650" height="297"></p>			<p style="text-align: left">			右上角會出現&lt;列印本頁&gt;文字，當滑鼠移上去時會顯示可以click按下的指標，按下滑鼠左鍵後，會跳出alert 視窗：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610017.jpg"></p>			<p style="text-align: left">			接著按下確定，會出現列印對話方塊：</p>			<p style="text-align: left">			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (下)_files/201103201610018.jpg"></p>			<p style="text-align: left">			上述這個功能可以用在隱藏menu bar 及tool bar 時，使用者可以於頁面上直接做列印動作。</p>			<p>			<b>結語：<br>			</b>在尚未接觸用程式產生PDF 			檔案之前，對PDF只有很粗淺的認識，猜測大致上應該就只是某種檔案格式。真正接觸後才發現真是挖到寶庫，尤其是有這麼強大函式庫可供使用，對程式開發者來說簡直是如虎添翼。還有沒有其他功能尚未介紹？答案是有的，而且還很多，再找時間介紹給各位讀者。各位若有需求，可以先從參考資料中開始找起，也許您會得到更多。<br>　</p>			<p>			<b>參考資料</b></p>			<ol>				<li>				<p style="text-align: left">主要教學網站<br>				http://itextpdf.com/index.php				<a href="http://www.mikesdotnetting.com/Article/80/Create-PDFs-in-ASP.NET-getting-started-with-iTextSharp">				http://www.mikesdotnetting.com/Article/80/Create-PDFs-in-ASP.NET-getting-started-with-iTextSharp</a>				</p></li>				<li>				<p style="text-align: left">浮水印Watermark 製作<a href="http://footheory.com/blogs/donnfelker/archive/2008/05/11/using-itextsharp-to-watermark-write-text-to-existing-pdf-s.aspx">http://footheory.com/blogs/donnfelker/archive/2008/05/11/using-itextsharp-to-watermark-write-text-to-existing-pdf-s.aspx</a></p>				</li>				<li>				<p style="text-align: left">書籤Bookmark製作<br>				<a href="http://www.mazsoft.com/blog/post/2008/04/30/Code-sample-for-using-iTextSharp-PDF-library.aspx">				http://www.mazsoft.com/blog/post/2008/04/30/Code-sample-for-using-iTextSharp-PDF-library.aspx</a></p>				</li>				<li>				<p style="text-align: left">Footer 製作<br>				<a href="http://stackoverflow.com/questions/1032614/itextsharp-creating-a-footer-page-of">				http://stackoverflow.com/questions/1032614/itextsharp-creating-a-footer-page-of</a></p>				</li>			</ol>			</td>		  </tr>		 		</tbody></table>	</td>  </tr>   <tr>			<td class="ep_foot" align="center" colspan="6"><font size="2">版權所有 &#169; <a href="http://www.cc.ntu.edu.tw/">國立台灣大學計算機及資訊網路中心 </a>All				Rights Reserved. <br>電話：02-33665022 或 3366-5023 傳真： 02-23637204<br>				讀者意見信箱：<a href="mailto:ntuccepaper@ntu.edu.tw?subject=%E6%8A%95%E7%A8%BF%E8%87%BA%E7%81%A3%E5%A4%A7%E5%AD%B8%E8%A8%88%E7%AE%97%E6%A9%9F%E5%8F%8A%E8%B3%87%E8%A8%8A%E7%B6%B2%E8%B7%AF%E4%B8%AD%E5%BF%83%E9%9B%BB%E5%AD%90%E5%A0%B1">ntuccepaper@ntu.edu.tw</a> 				  <br>				  地址：10617 臺北市羅斯福路四段一號<br>				  建議最佳螢幕解析度 1024*768</font></td>    </tr></tbody></table></center></body></html>
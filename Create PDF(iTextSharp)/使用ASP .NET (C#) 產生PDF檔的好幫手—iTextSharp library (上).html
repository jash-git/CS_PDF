<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0062)http://www.cc.ntu.edu.tw/chinese/epaper/0015/20101220_1509.htm -->
<html xmlns="http://www.w3.org/TR/REC-html40" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml"><head><meta http-equiv="Content-Type" content="text/html; charset=Big5"><title>使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)</title><link rel="stylesheet" type="text/css" href="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/adress.css"><style type="text/css"><!--body {	background-image: url('../0002/images/square.gif');}--></style></head><body link="#49B3C1"><center><table width="800" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">   <tbody><tr bgcolor="#000000" class="eptop">    <td align="right" height="20">│ 	<a href="http://www.cc.ntu.edu.tw/chinese/epaper/editor.htm">編輯室</a> │ <a href="http://www.ntu.edu.tw/" target="_blank">臺大首頁</a> │ <a href="http://www.cc.ntu.edu.tw/" target="_blank">計中首頁</a> │ 	 </td>  </tr>  <tr>    <td height="150" align="right" valign="bottom" background="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/headimage.jpg" class="ep_head">	<p style="margin-top: 0">第0015期 	• 2010.12.20 發行</p><p style="margin-top: 0">	<span lang="EN-GB" style="font-family: Arial,sans-serif">		<strong><font size="3">ISSN 2077-8813</font></strong></span></p></td>  </tr></tbody></table>  <table width="800" border="0" cellpadding="0" cellspacing="1" bgcolor="#FFFFFF">   <tbody><tr align="center" bgcolor="#DAD8DA" class="eptop1">    <td align="center">	<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/button.gif" align="middle" width="13" height="13">	<a href="http://epaper.ntu.edu.tw/?p=view&amp;listid=2">歷史回顧</a></td>	<td align="center">	<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/button.gif" align="middle" width="13" height="13">	 <a href="http://epaper.ntu.edu.tw/?setlanguage=zh-tw&amp;p=subscribe&amp;id=1&amp;listid=2">	訂閱/取消</a></td>    <td align="center">	<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/button.gif" align="middle" width="13" height="13"><font size="3">	<a href="http://www.cc.ntu.edu.tw/chinese/epaper/0015/#service">校務服務</a></font></td>    <td align="center">	<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/button.gif" align="middle" width="13" height="13"><font size="3">	<a href="http://www.cc.ntu.edu.tw/chinese/epaper/0015/#report">專題報導</a></font></td>    <td align="center">	&nbsp;<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/button.gif" align="middle" width="13" height="13"><font size="3">	</font>	<a style="font-size: 12pt" href="http://www.cc.ntu.edu.tw/chinese/epaper/0015/#forum">技術論壇</a></td>    <td align="center">	<font size="3">	<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/button.gif" align="middle" width="13" height="13">  	<a href="http://www.cc.ntu.edu.tw/chinese/epaper/0015/#ntuepaper">推薦刊物</a></font></td>  </tr>  <tr align="center">    <td align="center" colspan="6" width="800">	<table width="740" border="0" cellpadding="0" cellspacing="1" bgcolor="#FFFFFF"> 		  <tbody><tr>			<td class="epimg" height="24">			<a href="http://www.cc.ntu.edu.tw/chinese/epaper/0015/index.html">首頁</a> &gt;技術論壇</td>		  </tr>		  <tr>			<td class="headline" background="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/bg.jpg">			<img src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/button1.gif" align="middle" width="13" height="13"> 			<strong>技術論壇</strong></td>		  </tr>		  <tr>			<td valign="top" class="epcontent">			<h1 class="style2">使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)</h1>			作者：唐瑤瑤 / 臺灣大學計算機及資訊網路中心程式設計組程式設計師<hr size="1" color="#CCCCCC">            			<p>			由於工作內容需要使用ASP .NET C#產生PDF檔，但是微軟的.NET framework 並沒有內建產生PDF 			的功能，所以只能上網找Third-Party 			提供的函式庫。請出Google大神幫忙，搜尋出來的結果有上萬筆，在沒有頭緒的情況下真是大海撈針。搜尋結果中有很多PDF 			函式庫是要付費的，就先將它排除，我們將搜尋範圍縮小至free又能支援中文後，終於讓我找到一個很實用且容易上手的library — 			iTextSharp。</p>			<p>			本函式庫原名是iText，主要是支援Java程式語言。之後針對Microsoft .NET C 			Sharp做了一個版本，也就是我們今天要介紹的iTextSharp。針對PDF檔案的製作與修改，支援的功能如下：</p>			<p>			1. Create：Automate、Convert、Sign、Encrypt。<br>			2. Read：Extract。<br>			3. Update：Stamp、Fill out、Split/Merge、Convert、Sign、Encrypt。<br>			接下來就讓我帶領大家一步一步用程式碼產生PDF 檔。</p>			<p>			<b>開發環境<br>			</b>1. 我的ASP .NET開發環境是Microsoft Visual Studio 2010 版，使用的程式語言是C#。<br>			2. iTextSharp 目前版本是5.0.4，下載位置：http://sourceforge.net/projects/itextsharp/ 			。請先下載zip，解壓縮後只有一個dll檔，利用Add Reference方式將itextsharp.dll 			加入您微軟專案的Bin目錄中，就這麼簡單而且可以開始coding了。</p>			<p>			Part 1：首先建立一個Web Application</p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509001.jpg"></p>			<p>			在這個範例中，我們利用web application在Server Memory產生pdf 檔後，使用者可以自行下載瀏覽或存檔，採用的是PdfWriter類別：<br>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509002.gif"></p>			<p>			若是要在Server FileSystem 先產生pdf檔，可以使用下列程式碼：<br>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509003.gif"></p>			<p>			在PDF檔案內容中要顯示中文，最重要的是字型設定，如果沒有正確設定中文字型，會造成中文無法顯示的問題。首先設定基本字型：kaiu.ttf 			是作業系統系統提供的標楷體字型，IDENTITY_H 是指編碼(The Unicode encoding with horizontal 			writing)，及是否要將字型嵌入PDF 檔中。再來針對基本字型做變化，例如Font 			Size、粗體斜體以及顏色等。當然你也可以採用其他中文字體字型。</p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509004.gif"></p>			<p class="MsoNormal"><span style="font-family: 新細明體">			開啟檔案寫入內容後，將檔案關閉。</span></p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509005.gif"></p>			<p>			到此階段，您已經產生了一個可以在瀏覽器端下載的檔案（檔名為pdfExample.pdf）。執行程式結果如下：</p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509006.jpg"></p>			<p>			選擇開啟舊檔，顯示如下圖：</p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509007.jpg"></p>			<p class="MsoNormal"><span class="googqs-tidbit-0"><b>			<span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">			Part 2</span><span style="font-family: 新細明體; color: #555555">：使用</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">chunk</span><span style="font-family: 新細明體; color: #555555">、</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">phrase</span><span style="font-family: 新細明體; color: #555555">及</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">paragraph</span><span style="font-family: 新細明體; color: #555555">建立文字段落內容</span></b></span></p>			<p class="MsoNormal" style="text-align: left">			<span class="googqs-tidbit-0">			<span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">			&nbsp;Paragraph</span><span style="font-family: 新細明體; color: #555555">是文章段落，可由</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">phrases 			(</span><span style="font-family: 新細明體; color: #555555">句子</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">)</span><span style="font-family: 新細明體; color: #555555">組成，然後</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">phrase</span><span style="font-family: 新細明體; color: #555555">又可以由</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">chunks(</span><span style="font-family: 新細明體; color: #555555">文字片段</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">)</span><span style="font-family: 新細明體; color: #555555">所組成。這樣的組成方式可以很方便的在文字段落中穿插不同的字型樣式。但要注意的是</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">chunk</span><span style="font-family: 新細明體; color: #555555">不會自動換行，必須自行插入換行符號</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">”\n”			</span><span style="font-family: 新細明體; color: #555555">或是使用</span></span><span class="cb21" style="color: #2B91AF"><span lang="EN-US" style="font-family: Courier New">Environment</span></span><span lang="EN-US" style="font-family: Courier New; color: black">.NewLine</span><span style="font-family: 新細明體; color: black">。至於</span><span class="googqs-tidbit-0"><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">Paragraph</span><span style="font-family: 新細明體; color: #555555">有許多樣式可以設定，像是</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">Alignment</span><span style="font-family: 新細明體; color: #555555">、</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">indentation</span><span style="font-family: 新細明體; color: #555555">、</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">leading</span><span style="font-family: 新細明體; color: #555555">及</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">spacing			</span><span style="font-family: 新細明體; color: #555555">等。</span></span></p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509008.gif"><br>&nbsp;<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509009.gif"></p>			<p>			執行結果如下：</p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509010.jpg"></p>			<p class="MsoNormal"><span class="googqs-tidbit-0"><b>			<span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">			Part 3</span><span style="font-family: 新細明體; color: #555555">：產生表格</span></b><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">&nbsp;</span></span></p>			<p class="MsoNormal"><span class="googqs-tidbit-0">			<span style="font-family: 新細明體; color: #555555">使用</span><span style="font-family: Trebuchet MS; color: #555555">			<span lang="EN-US">iTextSharp </span></span>			<span style="font-family: 新細明體; color: #555555">產生表格是十分直覺且容易的，類似</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">CSS</span><span style="font-family: 新細明體; color: #555555">的寫法。在建立</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">table			</span><span style="font-family: 新細明體; color: #555555">			時，可以很輕易用欄位相對寬度做設定，也可以給絕對寬度，或者單純的給予欄位數做平均等分，</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">ex:			</span></span>			<span lang="EN-US" style="font-family: Courier New; color: #2B91AF">			PdfPTable</span><span lang="EN-US" style="font-family: Courier New; color: black"> 			table = </span>			<span lang="EN-US" style="font-family: Courier New; color: blue">new</span><span lang="EN-US" style="font-family: Courier New; color: black">			</span>			<span lang="EN-US" style="font-family: Courier New; color: #2B91AF">			PdfPTable</span><span lang="EN-US" style="font-family: Courier New; color: black">(4);</span><span class="googqs-tidbit-0"><span style="font-family: 新細明體; color: #555555">。</span></span></p>			<p class="MsoNormal"><span class="googqs-tidbit-0">			<span style="font-family: 新細明體; color: #555555">比較值得注意的是，由於</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">PdfPTable</span><span style="font-family: 新細明體; color: #555555">表格裡面，每一格叫做</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">cell</span><span style="font-family: 新細明體; color: #555555">，因此在塞資料時，必須注意填寫方式是由左而右、由上而下。此外，</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">PdfpCell			</span><span style="font-family: 新細明體; color: #555555">有合併欄位的功能</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">Colspan</span><span style="font-family: 新細明體; color: #555555">，也有合併列的功能</span><span lang="EN-US" style="font-family: Trebuchet MS; color: #555555">Rowspan</span><span style="font-family: 新細明體; color: #555555">，我們可以利用這兩項特性將平淡的表格做些變化。請參考下面的範例：</span></span></p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509011.gif"><br>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509012.gif"><br>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509013.gif"></p>			<p>			執行結果如下圖：</p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509014.jpg"></p>			<p>			　</p>			<p>			<b>Part 4：插入圖片<br>			</b>iTextSharp 支援的image type包括：JPEG, JPEG2000, GIF, PNG, BMP, WMF, 			TIFF, and JBIG2。除了可以讀取伺服器本地端圖檔外，也可以直接指定圖檔的URL位置。我們延續表格的範例實作如下：<br>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509015.gif"></p>			<p>			執行結果如下圖：</p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509016.jpg"></p>			<p>			<b>Part 5：書籤<br>			</b>iTextSharp 			是透過Chapter類別及Section類別來產生樹狀結構的書籤功能。最上層的書籤必須是Chapter，且每個Chapter之開始必定是一個New 			Page，就是會自動換頁的意思。Section則須在Chapter 物件中，或是在另一個Section物件中，無法單獨存在。<br>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509017.gif"></p>			<p class="MsoNormal"><span class="googqs-tidbit-0">			<span style="font-family: 新細明體,serif; color: #555555">若要使用者一開啟</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">PDF</span><span style="font-family: 新細明體,serif; color: #555555">檔案時，書籤列就自動展開，請加上這一行程式碼：</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">&nbsp;</span></span></p>			<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse; font-size: 10.0pt; font-family: Calibri,sans-serif">				<tbody><tr>					<td width="557" valign="top" style="width:418.1pt;padding:0cm 5.4pt 0cm 5.4pt">					<p class="MsoNormal">					<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">					PdfWriter.ViewerPreferences = <span style="color:#2B91AF">					PdfWriter</span>.PageModeUseOutlines; </span>					<span class="googqs-tidbit-0"></span></p></td>				</tr>			</tbody></table>			<p>			執行結果如下圖：</p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509018.jpg"></p>			<p>			　</p>			<p>			<b>Part 6：浮水印<br>			</b>iTextSharp 產生浮水印(Watermark)的方式是使用PdfStamper 類別，且必須是針對已經產生之pdf檔做加工。在我們的範例中，請先產生一個儲存在server 			端的檔案，再經由PdfReader物件讀進來處理。<br>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509019.jpg"></p>			<p>			執行結果如下圖：</p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509020.jpg"></p>			<p>			　</p>			<p class="MsoNormal"><span class="googqs-tidbit-0"><b>			<span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">			Part 7</span><span style="font-family: 新細明體,serif; color: #555555">：文章加密及保護</span></b></span></p>			<p class="MsoNormal"><span class="googqs-tidbit-0">			<span style="font-family: 新細明體,serif; color: #555555">			若要使用者必須輸入密碼才能開啟</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">pdf</span><span style="font-family: 新細明體,serif; color: #555555">檔，</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">iTextSharp</span><span style="font-family: 新細明體,serif; color: #555555">的做法是針對已經產生之</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">pdf</span><span style="font-family: 新細明體,serif; color: #555555">檔做加工。在我們的範例中，請先產生一個儲存在</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">server			</span><span style="font-family: 新細明體,serif; color: #555555">			端的檔案，再經由</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">PdfReader</span><span style="font-family: 新細明體,serif; color: #555555">物件讀進來處理。一切安全性設定都是使用</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">PdfEncryptor			</span><span style="font-family: 新細明體,serif; color: #555555">物件。</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">&nbsp;</span></span></p>			<p class="MsoNormal">			<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New; color: #2B91AF">			PdfEncryptor</span><span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">.Encrypt 			(<span style="color:#2B91AF">PdfReader</span> reader,			<span style="color:#2B91AF">Stream</span> os,			<span style="color:blue">bool</span> strength,			<span style="color:blue">string</span> userPassword,			<span style="color:blue">string</span> ownerPassword,			<span style="color:blue">int</span> permissions);</span></p>			<p style="text-align: left">			<span style="font-size: 12.0pt; font-family: 新細明體,serif">			上述主要函式中，可以設定</span><span lang="EN-US" style="font-size: 12.0pt; font-family: Courier New">user 			password </span>			<span style="font-size: 12.0pt; font-family: 新細明體,serif">及</span><span lang="EN-US" style="font-size: 12.0pt; font-family: Courier New">owner 			password</span><span style="font-size: 12.0pt; font-family: 新細明體,serif">。一旦設定後，每次打開</span><span lang="EN-US" style="font-size: 12.0pt; font-family: Courier New">PDF			</span><span style="font-size: 12.0pt; font-family: 新細明體,serif">			檔時都必須輸入密碼。</span><span lang="EN-US" style="font-size: 12.0pt; font-family: Courier New">User 			password </span>			<span style="font-size: 12.0pt; font-family: 新細明體,serif">			可以讀檔，但不能列印及修改儲存；</span><span lang="EN-US" style="font-size: 12.0pt; font-family: Courier New">owner 			password </span>			<span style="font-size: 12.0pt; font-family: 新細明體,serif">則具有全部權限。</span></p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509021.jpg"></p>			<p>			下圖可以看到列印及存檔的圖示都被disable了</p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509022.jpg"></p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509023.gif"></p>			<p class="MsoNormal"><span style="font-family: 新細明體,serif">如果想要隱藏</span><span lang="EN-US">Menu 			Bar </span><span style="font-family: 新細明體,serif">及工具列，只要簡單的設定</span><span lang="EN-US">PdfWriter.ViewerPreferences</span><span style="font-family: 新細明體,serif">，這在之前介紹自動開啟書籤的做法時有使用過。</span><span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">&nbsp;</span></p>			<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse; font-size: 10.0pt; font-family: Calibri,sans-serif">				<tbody><tr>					<td width="557" valign="top" style="width:418.1pt;padding:0cm 5.4pt 0cm 5.4pt">					<p class="MsoNormal">					<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">					PdfWriter.ViewerPreferences = <span style="color:#2B91AF">					PdfWriter</span>.HideMenubar | <span style="color:#2B91AF">					PdfWriter</span>.HideToolbar;</span></p></td>				</tr>			</tbody></table>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509024.jpg"></p>			<p class="MsoNormal" style="text-align: left">			<span style="font-family: 新細明體,serif">			針對被保護的文件，如果想開放某些權限，例如讓使用者能列印，做法是在</span><span class="googqs-tidbit-0"><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">PdfEncryptor			</span><span style="font-family: 新細明體,serif; color: #555555">			物件中設定如下：</span></span></p>			<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse; font-size: 10.0pt; font-family: Calibri,sans-serif">				<tbody><tr>					<td width="557" valign="top" style="width:418.1pt;padding:0cm 5.4pt 0cm 5.4pt">					<p class="MsoNormal" style="margin-top: 0; margin-bottom: 0">					<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New; color: #2B91AF">					PdfEncryptor</span><span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">.Encrypt(reader, 					memoryStream,<span style="color:blue">null</span>,<span style="color:blue">null</span>,</span></p>					<p class="MsoNormal" style="margin-top: 0; margin-bottom: 0">					<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New; color: #2B91AF">					PdfWriter</span><span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">.AllowAssembly 					|<span style="color:#2B91AF">PdfWriter</span>.AllowFillIn|</span><span lang="EN-US" style="font-size: 9.5pt; font-family: 新細明體,serif">					</span>					<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New; color: #2B91AF">					PdfWriter</span><span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">.AllowScreenReaders|<span style="color:#2B91AF">PdfWriter</span>.AllowPrinting,</span><span lang="EN-US" style="font-size: 9.5pt; font-family: 新細明體,serif">					</span>					<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New; color: blue">					false</span><span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">);</span></p></td>				</tr>			</tbody></table>			<p class="MsoNormal">　</p>			<p class="MsoNormal"><span class="googqs-tidbit-0"><b>			<span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">			Part 8</span><span style="font-family: 新細明體,serif; color: #555555">：</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">Metadata</span></b><span style="font-family: 新細明體,serif; color: #555555"><br>			我們可以在</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">PDF			</span><span style="font-family: 新細明體,serif; color: #555555">文件的</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">metadata			</span><span style="font-family: 新細明體,serif; color: #555555">			中寫入一些值，但為防止被修改，建議搭配</span><span lang="EN-US" style="font-family: &#39;Trebuchet MS&#39;,sans-serif; color: #555555">PdfEncryptor			</span><span style="font-family: 新細明體,serif; color: #555555">物件使用。</span></span></p>			<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse; font-size: 10.0pt; font-family: Calibri,sans-serif">				<tbody><tr>					<td width="557" valign="top" style="width:418.1pt;padding:0cm 5.4pt 0cm 5.4pt">					<p class="MsoNormal" style="margin-top: 0; margin-bottom: 0px">					<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">					doc1.AddTitle(<span style="color:#A31515">"</span></span><span style="font-size: 9.5pt; font-family: Courier New; color: #A31515">介紹<span lang="EN-US">DPDF"</span></span><span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">);</span></p>					<p class="MsoNormal" style="margin-top: 0; margin-bottom: 0px">					<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">					doc1.AddAuthor(<span style="color:#A31515">"Dana Tang"</span>);</span></p>					<p class="MsoNormal" style="margin-top: 0; margin-bottom: 0px">					<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">					doc1.AddSubject(<span style="color:#A31515">"This example 					shows how to add metadata"</span>);</span></p>					<p class="MsoNormal" style="margin-top: 0; margin-bottom: 0px">					<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">					doc1.AddKeywords(<span style="color:#A31515">"Metadata, 					iText</span></span><span lang="EN-US" style="font-size: 9.5pt; font-family: 新細明體,serif; color: #A31515">Sharp</span><span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New; color: #A31515">, 					PDF"</span><span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">);</span></p>					<p class="MsoNormal" style="margin-top: 0; margin-bottom: 0px">					<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">					doc1.AddCreator(<span style="color:#A31515">"Using 					iTextSharp"</span>);</span></p>					<p class="MsoNormal" style="margin-top: 0; margin-bottom: 0px">					<span lang="EN-US" style="font-size: 9.5pt; font-family: Courier New">					doc1.Open();</span></p></td>				</tr>			</tbody></table>			<p class="MsoNormal"><span lang="EN-US">&nbsp;</span><span style="font-family: 新細明體,serif">開啟</span><span lang="EN-US">PDF</span><span style="font-family: 新細明體,serif">檔，選擇工具列</span><span style="font-family:&quot;新細明體&quot;,&quot;serif&quot;">【</span><span style="font-family: 新細明體,serif">檔案</span><span style="font-family:&quot;新細明體&quot;,&quot;serif&quot;">】→【</span><span style="font-family: 新細明體,serif">內容</span><span style="font-family:&quot;新細明體&quot;,&quot;serif&quot;">】</span><span style="font-family: 新細明體,serif">，即會看到如下圖所顯示：</span></p>			<p>			<img border="0" src="./使用ASP .NET (C#) 產生PDF檔的好幫手—iTextSharp library (上)_files/201012201509025.jpg"></p>			<p>			大功告成！是不是覺得iTextSharp 			功能很強大？我們現在已經可以產生一個專業級的PDF檔。事實上，iTextSharp還有許多進階功能，像是Header、Footer、Barcode、Direct 			content及JavaScript等互動功能，就留待下次再介紹給各位。</p>			<p>			　</p>			<p class="MsoNormal" style="text-align: left; margin-top: 0; margin-bottom: 0">			<b><span style="font-family: 新細明體,serif">參考資料<br>			</span></b><span lang="EN-US">1.</span><span style="font-family: 新細明體,serif">主要教學網站</span>			<br>			<span lang="EN-US"><a href="http://itextpdf.com/index.php">			http://itextpdf.com/index.php</a>			<a href="http://www.mikesdotnetting.com/Article/80/Create-PDFs-in-ASP.NET-getting-started-with-iTextSharp">			http://www.mikesdotnetting.com/Article/80/Create-PDFs-in-ASP.NET-getting-started-with-iTextSharp</a>			<br>			2.</span><span style="font-family: 新細明體,serif">浮水印</span><span lang="EN-US">Watermark</span><span style="font-family: 新細明體,serif">製作</span><br>			<span lang="EN-US">			<a href="http://footheory.com/blogs/donnfelker/archive/2008/05/11/using-itextsharp-to-watermark-write-text-to-existing-pdf-s.aspx">			http://footheory.com/blogs/donnfelker/archive/2008/05/11/using-itextsharp-to-watermark-write-text-to-existing-pdf-s.aspx</a>			<br>			</span>			<span class="MsoHyperlink" style="text-decoration: underline; text-underline: single">			<span lang="EN-US" style="text-decoration: none">3.</span></span><span style="font-family: 新細明體,serif">書籤</span><span lang="EN-US">Bookmark</span><span style="font-family: 新細明體,serif">製作<br>			</span><span lang="EN-US">			<a href="http://www.mazsoft.com/blog/post/2008/04/30/Code-sample-for-using-iTextSharp-PDF-library.aspx">			http://www.mazsoft.com/blog/post/2008/04/30/Code-sample-for-using-iTextSharp-PDF-library.aspx</a><span class="MsoHyperlink" style="color: blue; text-decoration: underline; text-underline: single"><br>			</span>4.Footer </span><span style="font-family: 新細明體,serif">製作</span><br>			<span lang="EN-US">			<a href="http://stackoverflow.com/questions/1032614/itextsharp-creating-a-footer-page-of">			http://stackoverflow.com/questions/1032614/itextsharp-creating-a-footer-page-of</a></span></p></td>		  </tr>		 		</tbody></table>	</td>  </tr>   <tr>			<td class="ep_foot" align="center" colspan="6"><font size="2">版權所有 &#169; <a href="http://www.cc.ntu.edu.tw/">國立台灣大學計算機及資訊網路中心 </a>All				Rights Reserved. <br>電話：02-33665022 或 3366-5023 傳真： 02-23637204<br>				讀者意見信箱：<a href="mailto:ntuccepaper@ntu.edu.tw?subject=%E6%8A%95%E7%A8%BF%E8%87%BA%E7%81%A3%E5%A4%A7%E5%AD%B8%E8%A8%88%E7%AE%97%E6%A9%9F%E5%8F%8A%E8%B3%87%E8%A8%8A%E7%B6%B2%E8%B7%AF%E4%B8%AD%E5%BF%83%E9%9B%BB%E5%AD%90%E5%A0%B1">ntuccepaper@ntu.edu.tw</a> 				  <br>				  地址：10617 臺北市羅斯福路四段一號<br>				  建議最佳螢幕解析度 1024*768</font></td>    </tr></tbody></table></center></body></html>